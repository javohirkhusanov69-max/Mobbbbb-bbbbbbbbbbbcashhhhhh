<!DOCTYPE html>
<html lang="ar">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ByTroX Mobcash</title>
  <style>
    body { font-family: 'Arial', sans-serif; margin: 0; padding: 0; background-color: #f5f5f5; color: #333; direction: rtl; }
    h1 { text-align: center; background-color: #4CAF50; color: white; padding: 20px; margin: 0; }
    .container { max-width: 600px; margin: 20px auto; background: white; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-radius: 8px; }
    form { display: flex; flex-direction: column; gap: 15px; }
    label { font-size: 16px; font-weight: bold; }
    input[type="text"], input[type="number"] { width: 100%; padding: 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
    button { background-color: #4CAF50; color: white; border: none; padding: 10px; font-size: 16px; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; }
    button:hover { background-color: #45a049; }
    .message { margin-top: 10px; font-size: 16px; text-align: center; }
    .error { color: #d9534f; }
    .success { color: #5cb85c; }

    #adminMenu { display: none; }
  </style>
</head>
<body>
 
  <h1>𝗕𝗬𝗧𝗥𝗢𝗫 𝗠𝗢𝗕𝗖𝗔𝗦𝗛</h1>

  <div class="container">
    <form id="idForm">
      <label for="username">اسم المستخدم:</label>
      <input type="text" id="username" placeholder="" required autocomplete="off">
      <button type="submit">بحث</button>
      <div id="idMsg" class="message"></div>
    </form>

    <div id="adminMenu">
      <form id="balanceForm">
        <input type="hidden" id="currentId">
        <label for="balance">الرصيد:</label>
        <input type="number" id="balance" value="0">
        <label for="ban">حظر عند:</label>
        <input type="number" id="ban" value="0">
        <button type="submit">تحديث الرصيد</button>
      </form>
      <p class="message" id="updateMsg"></p>
    </div>
  </div>

<script>
   

  document.querySelectorAll('form').forEach(f=>{
    f.addEventListener('submit', (e)=>{
      e.preventDefault();
      decrementVisit();
    });
  });

  
  // --- Faqat qo‘lda o‘rnatiladigan tizim random yo‘q) ---
  const EXPIRE_MS = 3*24*60*60*1000;

  const idForm = document.getElementById('idForm');
  const idMsg = document.getElementById('idMsg');
  const adminMenu = document.getElementById('adminMenu');
  const balanceForm = document.getElementById('balanceForm');
  const updateMsg = document.getElementById('updateMsg');
  const usernameInput = document.getElementById('username');
  const currentIdInput = document.getElementById('currentId');
  const balanceInput = document.getElementById('balance');
  const banInput = document.getElementById('ban');

  function keyFor(id){ return 'mobcash_'+id; }
  function getStored(id){
    try{
      const raw = localStorage.getItem(keyFor(id));
      if(!raw) return null;
      const obj = JSON.parse(raw);
      if(!obj || !obj.createdAt) return null;
      if(Date.now() - obj.createdAt > EXPIRE_MS){ localStorage.removeItem(keyFor(id)); return null; }
      return obj;
    }catch(e){ return null; }
  }
  function saveStored(id,obj){ obj.createdAt=obj.createdAt||Date.now(); localStorage.setItem(keyFor(id), JSON.stringify(obj)); }

  idForm.addEventListener('submit',function(e){
    e.preventDefault();
    updateMsg.textContent=''; idMsg.textContent='';
    const raw = usernameInput.value.trim();

    if(!/^\d+$/.test(raw) || !(raw.length===10 || raw.length===11)){
      adminMenu.style.display='none';
      idMsg.textContent='User not found.'; idMsg.className='message error'; return;
    }

    const id=raw; currentIdInput.value=id;
    let stored=getStored(id);
    if(!stored){
      stored={ balance:0, ban:0 };
      saveStored(id,stored);
    }

    balanceInput.value=stored.balance??0;
    banInput.value=stored.ban??0;
    adminMenu.style.display='block';
  });

  balanceForm.addEventListener('submit',function(e){
    e.preventDefault();
    const id=currentIdInput.value; if(!id) return;
    const b=parseInt(balanceInput.value)||0; const ban=parseInt(banInput.value)||0;
    let stored=getStored(id)||{};
    stored.balance=b; stored.ban=ban;
    stored.createdAt=stored.createdAt||Date.now();
    saveStored(id,stored);

    updateMsg.textContent='Balance updated successfully.'; updateMsg.className='message success';
  });
</script>
</body>
</html>
